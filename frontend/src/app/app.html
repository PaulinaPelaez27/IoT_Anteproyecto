<div class="flex h-screen overflow-hidden">
  <!-- Global Rail -->
  <app-global-rail class="flex-shrink-0"></app-global-rail>
  
  <!-- Context Sidebar -->
  <div class="w-sidebar bg-gray-50 border-r border-gray-200 flex flex-col">
    <!-- Monitoring Sidebar -->
    @if (navService.activeSection() === 'monitoring') {
      <!-- Company Switcher (admin/tech only) -->
      @if (authService.canSwitchCompany()) {
        <div class="p-4 border-b border-gray-200">
          <select 
            [value]="companyService.selectedCompanyId()"
            (change)="companyService.selectCompany($any($event.target).value)"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
            @for (company of companyService.companies(); track company.id) {
              <option [value]="company.id">{{ company.name }}</option>
            }
          </select>
        </div>
      }
      
      <!-- Project List -->
      <div class="flex-1 overflow-y-auto p-4">
        <div class="flex items-center justify-between mb-4">
          <h2 class="text-lg font-semibold text-gray-900">Projects</h2>
          <button class="px-3 py-1 bg-primary text-white rounded-lg text-sm hover:bg-primary-700 transition-colors">
            + New
          </button>
        </div>
        
        <div class="space-y-2">
          @for (project of projects(); track project.id) {
            <a 
              [routerLink]="['/project', project.id]"
              routerLinkActive="border-l-4 border-primary bg-white"
              class="block p-3 rounded-lg hover:bg-white transition-colors cursor-pointer">
              <h3 class="font-medium text-gray-900">{{ project.name }}</h3>
              <p class="text-sm text-gray-500 mt-1">{{ project.description }}</p>
            </a>
          }
        </div>
      </div>
    }

    <!-- Admin Sidebar -->
    @if (navService.activeSection() === 'admin') {
      <div class="flex-1 overflow-y-auto p-4">
        <h2 class="text-lg font-semibold text-gray-900 mb-4">Admin</h2>
        <div class="space-y-2">
          <a 
            routerLink="/admin/users"
            routerLinkActive="border-l-4 border-primary bg-white"
            class="block p-3 rounded-lg hover:bg-white transition-colors cursor-pointer">
            <div class="flex items-center justify-between">
              <span class="font-medium text-gray-900">Users</span>
              <span class="px-2 py-1 bg-gray-200 text-gray-700 rounded-full text-xs">4</span>
            </div>
          </a>
          <a 
            routerLink="/admin/companies"
            routerLinkActive="border-l-4 border-primary bg-white"
            class="block p-3 rounded-lg hover:bg-white transition-colors cursor-pointer">
            <div class="flex items-center justify-between">
              <span class="font-medium text-gray-900">Companies</span>
              <span class="px-2 py-1 bg-gray-200 text-gray-700 rounded-full text-xs">3</span>
            </div>
          </a>
          <a 
            routerLink="/admin/roles"
            routerLinkActive="border-l-4 border-primary bg-white"
            class="block p-3 rounded-lg hover:bg-white transition-colors cursor-pointer">
            <div class="flex items-center justify-between">
              <span class="font-medium text-gray-900">Roles</span>
              <span class="px-2 py-1 bg-gray-200 text-gray-700 rounded-full text-xs">3</span>
            </div>
          </a>
        </div>
      </div>
    }

    <!-- Settings Sidebar -->
    @if (navService.activeSection() === 'settings') {
      <div class="flex-1 overflow-y-auto p-4">
        <h2 class="text-lg font-semibold text-gray-900 mb-4">Settings</h2>
        <div class="space-y-2">
          <a 
            routerLink="/settings/profile"
            routerLinkActive="border-l-4 border-primary bg-white"
            class="block p-3 rounded-lg hover:bg-white transition-colors cursor-pointer">
            <span class="font-medium text-gray-900">Profile</span>
          </a>
          <a 
            routerLink="/settings/security"
            routerLinkActive="border-l-4 border-primary bg-white"
            class="block p-3 rounded-lg hover:bg-white transition-colors cursor-pointer">
            <span class="font-medium text-gray-900">Security</span>
          </a>
          <a 
            routerLink="/settings/notifications"
            routerLinkActive="border-l-4 border-primary bg-white"
            class="block p-3 rounded-lg hover:bg-white transition-colors cursor-pointer">
            <span class="font-medium text-gray-900">Notifications</span>
          </a>
        </div>
      </div>
    }
  </div>
  
  <!-- Main Content Area -->
  <div class="flex-1 overflow-y-auto bg-white">
    <router-outlet></router-outlet>
  </div>
</div>
